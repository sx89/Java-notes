# 生成原生sql

```go

// genQuerySQL 根据请求对象生成过滤sql的条件
func (d *Dao) genQuerySQL(ctx context.Context, fm *model.FilterMark, baseSQL string) (filterSQL string, err error) {
	var (
		_whereCond string
		_orderCond string
		_cmpCond   string
		_where     = make([]string, 0)
		fq         = fm.FilterVideosReq
	)
	if fq.SortColumn == "" {
		fq.SortColumn = "id"
	}
	if vi := fm.VideoIndex; vi != nil {
		var value interface{}
		if value, err = getFieldValue(ctx, vi, fq.SortColumn); err != nil {
			return
		}
		// 处理不同类型
		switch fq.SortColumn {
		case "id", "svid":
			if value.(int64) == 0 && fq.Reverse {
				value = math.MaxInt64
			}
			strValue := strconv.FormatInt(value.(int64), 10)
			_cmpCond = d.cmpCond(fq.SortColumn, strValue, fq.Reverse)
		case "mtime":
		default:
			err = bbq_ecode.ReqParamErr
			log.Errorw(ctx, "log", "get field error", "error", err, "field", fq.SortColumn)
			return
		}
	}

	_where = append(_where, " 1=1 ") // 方便处理AND和无where的情况
	_where = append(_where, _cmpCond)
	_where = append(_where, d.inCond(_idInCond, xstr.JoinInts(fq.Ids)))
	_where = append(_where, d.inCond(_midInCond, xstr.JoinInts(fq.Mids)))
	_where = append(_where, d.inCond(_svidInCond, xstr.JoinInts(fq.Svids)))
	_where = append(_where, d.inCond(_cidInCond, xstr.JoinInts(fq.Cids)))
	_where = append(_where, d.inCond(_recLevelInCond, model.JoinInt32(fq.RecLevels...)))
	_where = append(_where, d.inCond(_showLevelInCond, model.JoinInt32(fq.ShowLevels...)))
	_where = append(_where, d.inCond(_stateInCond, model.JoinInt32(fq.States...)))
	_where = append(_where, d.inCond(_expInCond, model.JoinInt32(fq.Exps...)))
	_orderCond = d.orderCond(fq.SortColumn, fq.Reverse)
	_whereCond = d.andCond(_where)

	filterSQL = fmt.Sprintf(baseSQL, _whereCond, _orderCond, fm.FilterVideosReq.Limit)

	return
}
```$

# logError 几种用法



# 
